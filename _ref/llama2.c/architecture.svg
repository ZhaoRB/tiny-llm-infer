<svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="-7.5 -8 1595.111328125 2893.5" style="max-width: 1595.111328125px;" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-svg-1753804172703-07orbrmyt"><style>#mermaid-svg-1753804172703-07orbrmyt{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#cccccc;}#mermaid-svg-1753804172703-07orbrmyt .error-icon{fill:#5a1d1d;}#mermaid-svg-1753804172703-07orbrmyt .error-text{fill:#f85149;stroke:#f85149;}#mermaid-svg-1753804172703-07orbrmyt .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-1753804172703-07orbrmyt .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-1753804172703-07orbrmyt .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-1753804172703-07orbrmyt .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-1753804172703-07orbrmyt .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-1753804172703-07orbrmyt .marker{fill:#cccccc;stroke:#cccccc;}#mermaid-svg-1753804172703-07orbrmyt .marker.cross{stroke:#cccccc;}#mermaid-svg-1753804172703-07orbrmyt svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-1753804172703-07orbrmyt .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#cccccc;}#mermaid-svg-1753804172703-07orbrmyt .cluster-label text{fill:#cccccc;}#mermaid-svg-1753804172703-07orbrmyt .cluster-label span,#mermaid-svg-1753804172703-07orbrmyt p{color:#cccccc;}#mermaid-svg-1753804172703-07orbrmyt .label text,#mermaid-svg-1753804172703-07orbrmyt span,#mermaid-svg-1753804172703-07orbrmyt p{fill:#cccccc;color:#cccccc;}#mermaid-svg-1753804172703-07orbrmyt .node rect,#mermaid-svg-1753804172703-07orbrmyt .node circle,#mermaid-svg-1753804172703-07orbrmyt .node ellipse,#mermaid-svg-1753804172703-07orbrmyt .node polygon,#mermaid-svg-1753804172703-07orbrmyt .node path{fill:#1f1f1f;stroke:#3c3c3c;stroke-width:1px;}#mermaid-svg-1753804172703-07orbrmyt .flowchart-label text{text-anchor:middle;}#mermaid-svg-1753804172703-07orbrmyt .node .label{text-align:center;}#mermaid-svg-1753804172703-07orbrmyt .node.clickable{cursor:pointer;}#mermaid-svg-1753804172703-07orbrmyt .arrowheadPath{fill:#e0e0e0;}#mermaid-svg-1753804172703-07orbrmyt .edgePath .path{stroke:#cccccc;stroke-width:2.0px;}#mermaid-svg-1753804172703-07orbrmyt .flowchart-link{stroke:#cccccc;fill:none;}#mermaid-svg-1753804172703-07orbrmyt .edgeLabel{background-color:#1f1f1f99;text-align:center;}#mermaid-svg-1753804172703-07orbrmyt .edgeLabel rect{opacity:0.5;background-color:#1f1f1f99;fill:#1f1f1f99;}#mermaid-svg-1753804172703-07orbrmyt .labelBkg{background-color:rgba(31, 31, 31, 0.5);}#mermaid-svg-1753804172703-07orbrmyt .cluster rect{fill:#3a3d41;stroke:#313131;stroke-width:1px;}#mermaid-svg-1753804172703-07orbrmyt .cluster text{fill:#cccccc;}#mermaid-svg-1753804172703-07orbrmyt .cluster span,#mermaid-svg-1753804172703-07orbrmyt p{color:#cccccc;}#mermaid-svg-1753804172703-07orbrmyt div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:#616161;border:1px solid #0078d4;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-1753804172703-07orbrmyt .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#cccccc;}#mermaid-svg-1753804172703-07orbrmyt :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-svg-1753804172703-07orbrmyt .input&gt;*{fill:#e3f2fd!important;}#mermaid-svg-1753804172703-07orbrmyt .input span{fill:#e3f2fd!important;}#mermaid-svg-1753804172703-07orbrmyt .embedding&gt;*{fill:#f1f8e9!important;}#mermaid-svg-1753804172703-07orbrmyt .embedding span{fill:#f1f8e9!important;}#mermaid-svg-1753804172703-07orbrmyt .norm&gt;*{fill:#fff3e0!important;}#mermaid-svg-1753804172703-07orbrmyt .norm span{fill:#fff3e0!important;}#mermaid-svg-1753804172703-07orbrmyt .linear&gt;*{fill:#fce4ec!important;}#mermaid-svg-1753804172703-07orbrmyt .linear span{fill:#fce4ec!important;}#mermaid-svg-1753804172703-07orbrmyt .attention&gt;*{fill:#e8f5e8!important;}#mermaid-svg-1753804172703-07orbrmyt .attention span{fill:#e8f5e8!important;}#mermaid-svg-1753804172703-07orbrmyt .activation&gt;*{fill:#f3e5f5!important;}#mermaid-svg-1753804172703-07orbrmyt .activation span{fill:#f3e5f5!important;}#mermaid-svg-1753804172703-07orbrmyt .output&gt;*{fill:#e1f5fe!important;}#mermaid-svg-1753804172703-07orbrmyt .output span{fill:#e1f5fe!important;}</style><g><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="6" viewBox="0 0 10 10" class="marker flowchart" id="mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"/></marker><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart" id="mermaid-svg-1753804172703-07orbrmyt_flowchart-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart" id="mermaid-svg-1753804172703-07orbrmyt_flowchart-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart" id="mermaid-svg-1753804172703-07orbrmyt_flowchart-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart" id="mermaid-svg-1753804172703-07orbrmyt_flowchart-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart" id="mermaid-svg-1753804172703-07orbrmyt_flowchart-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"/></marker><g class="root"><g class="clusters"/><g class="edgePaths"><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-B" id="L-A-B-0" d="M1428.139,1014.75L1428.139,1179.375C1428.139,1344,1428.139,1673.25,1428.139,1841.158C1428.139,2009.067,1428.139,2015.633,1428.139,2018.917L1428.139,2022.2"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-C" id="L-B-C-0" d="M1428.139,2079.5L1428.139,2083.667C1428.139,2087.833,1428.139,2096.167,1428.139,2103.617C1428.139,2111.067,1428.139,2117.633,1428.139,2120.917L1428.139,2124.2"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-D" id="L-C-D-0" d="M1428.139,2181.5L1428.139,2185.667C1428.139,2189.833,1428.139,2198.167,1428.139,2205.617C1428.139,2213.067,1428.139,2219.633,1428.139,2222.917L1428.139,2226.2"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D LE-E" id="L-D-E-0" d="M1428.139,2283.5L1428.139,2287.667C1428.139,2291.833,1428.139,2300.167,1428.139,2307.617C1428.139,2315.067,1428.139,2321.633,1428.139,2324.917L1428.139,2328.2"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-E LE-F" id="L-E-F-0" d="M1428.139,2367L1428.139,2371.167C1428.139,2375.333,1428.139,2383.667,1428.139,2391.117C1428.139,2398.567,1428.139,2405.133,1428.139,2408.417L1428.139,2411.7"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-F LE-G" id="L-F-G-0" d="M1428.139,2450.5L1428.139,2454.667C1428.139,2458.833,1428.139,2467.167,1428.139,2474.617C1428.139,2482.067,1428.139,2488.633,1428.139,2491.917L1428.139,2495.2"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-G LE-H" id="L-G-H-0" d="M1428.139,2534L1428.139,2538.167C1428.139,2542.333,1428.139,2550.667,1428.139,2558.117C1428.139,2565.567,1428.139,2572.133,1428.139,2575.417L1428.139,2578.7"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-H LE-I" id="L-H-I-0" d="M1428.139,2654.5L1428.139,2658.667C1428.139,2662.833,1428.139,2671.167,1428.139,2678.617C1428.139,2686.067,1428.139,2692.633,1428.139,2695.917L1428.139,2699.2"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-I LE-J" id="L-I-J-0" d="M1428.139,2775.5L1428.139,2779.667C1428.139,2783.833,1428.139,2792.167,1428.139,2799.617C1428.139,2807.067,1428.139,2813.633,1428.139,2816.917L1428.139,2820.2"/></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(-7.5, -8)" class="root"><g class="clusters"><g id="TL" class="cluster default flowchart-label"><rect height="1977.5" width="1273.923828125" y="8" x="8" ry="0" rx="0" style=""/><g transform="translate(527.5166015625, 8)" class="cluster-label"><foreignObject height="18.5" width="234.890625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Single Transformer Layer Process</span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T1 LE-T2" id="L-T1-T2-0" d="M678.68,85L678.68,89.167C678.68,93.333,678.68,101.667,678.68,109.117C678.68,116.567,678.68,123.133,678.68,126.417L678.68,129.7"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T2 LE-T3" id="L-T2-T3-0" d="M552.535,187.736L501.118,194.863C449.701,201.991,346.866,216.245,295.449,226.656C244.031,237.067,244.031,243.633,244.031,246.917L244.031,250.2"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T2 LE-T4" id="L-T2-T4-0" d="M678.68,205.5L678.68,209.667C678.68,213.833,678.68,222.167,678.68,229.617C678.68,237.067,678.68,243.633,678.68,246.917L678.68,250.2"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T2 LE-T5" id="L-T2-T5-0" d="M804.824,190.8L845.441,197.416C886.058,204.033,967.292,217.267,1007.909,233.967C1048.525,250.667,1048.525,270.833,1048.525,291C1048.525,311.167,1048.525,331.333,1048.525,349.917C1048.525,368.5,1048.525,385.5,1048.525,402.5C1048.525,419.5,1048.525,436.5,1048.525,448.283C1048.525,460.067,1048.525,466.633,1048.525,469.917L1048.525,473.2"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T3 LE-T6" id="L-T3-T6-0" d="M244.031,326.5L244.031,330.667C244.031,334.833,244.031,343.167,244.031,350.617C244.031,358.067,244.031,364.633,244.031,367.917L244.031,371.2"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T4 LE-T7" id="L-T4-T7-0" d="M678.68,326.5L678.68,330.667C678.68,334.833,678.68,343.167,678.68,350.617C678.68,358.067,678.68,364.633,678.68,367.917L678.68,371.2"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T5 LE-T8" id="L-T5-T8-0" d="M1048.525,549.5L1048.525,553.667C1048.525,557.833,1048.525,566.167,1048.525,575.158C1048.525,584.15,1048.525,593.8,1048.525,598.625L1048.525,603.45"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T6 LE-T9" id="L-T6-T9-0" d="M244.031,428.5L244.031,432.667C244.031,436.833,244.031,445.167,244.031,454.2C244.031,463.233,244.031,472.967,244.031,477.833L244.031,482.7"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T7 LE-T10" id="L-T7-T10-0" d="M678.68,428.5L678.68,432.667C678.68,436.833,678.68,445.167,678.68,454.2C678.68,463.233,678.68,472.967,678.68,477.833L678.68,482.7"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T8 LE-T11" id="L-T8-T11-0" d="M1048.525,660.75L1048.525,666.458C1048.525,672.167,1048.525,683.583,1048.525,694.117C1048.525,704.65,1048.525,714.3,1048.525,719.125L1048.525,723.95"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T9 LE-T12" id="L-T9-T12-0" d="M244.031,540L244.031,545.75C244.031,551.5,244.031,563,258.209,572.681C272.387,582.361,300.744,590.223,314.922,594.153L329.1,598.084"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T10 LE-T12" id="L-T10-T12-0" d="M678.68,540L678.68,545.75C678.68,551.5,678.68,563,664.502,572.681C650.323,582.361,621.967,590.223,607.789,594.153L593.611,598.084"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T12 LE-T13" id="L-T12-T13-0" d="M461.355,670L461.355,674.167C461.355,678.333,461.355,686.667,461.355,694.117C461.355,701.567,461.355,708.133,461.355,711.417L461.355,714.7"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T13 LE-T14" id="L-T13-T14-0" d="M461.355,772L461.355,776.167C461.355,780.333,461.355,788.667,473.948,796.738C486.54,804.81,511.725,812.62,524.318,816.525L536.91,820.43"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T11 LE-T14" id="L-T11-T14-0" d="M1048.525,762.75L1048.525,768.458C1048.525,774.167,1048.525,785.583,1014.348,796.533C980.171,807.482,911.817,817.965,877.64,823.206L843.463,828.447"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T14 LE-T15" id="L-T14-T15-0" d="M655.643,892.5L655.643,896.667C655.643,900.833,655.643,909.167,655.643,916.617C655.643,924.067,655.643,930.633,655.643,933.917L655.643,937.2"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T15 LE-T16" id="L-T15-T16-0" d="M655.643,994.5L655.643,998.667C655.643,1002.833,655.643,1011.167,655.643,1018.617C655.643,1026.067,655.643,1032.633,655.643,1035.917L655.643,1039.2"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T16 LE-T17" id="L-T16-T17-0" d="M655.643,1115.5L655.643,1119.667C655.643,1123.833,655.643,1132.167,655.643,1139.617C655.643,1147.067,655.643,1153.633,655.643,1156.917L655.643,1160.2"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T17 LE-T18" id="L-T17-T18-0" d="M655.643,1236L655.643,1240.167C655.643,1244.333,655.643,1252.667,655.643,1260.117C655.643,1267.567,655.643,1274.133,655.643,1277.417L655.643,1280.7"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T18 LE-T19" id="L-T18-T19-0" d="M529.498,1339.032L479.286,1346.11C429.074,1353.188,328.65,1367.344,278.438,1377.705C228.227,1388.067,228.227,1394.633,228.227,1397.917L228.227,1401.2"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T18 LE-T20" id="L-T18-T20-0" d="M781.787,1339.574L829.89,1346.562C877.993,1353.55,974.199,1367.525,1022.301,1384.596C1070.404,1401.667,1070.404,1421.833,1070.404,1442C1070.404,1462.167,1070.404,1482.333,1070.404,1495.7C1070.404,1509.067,1070.404,1515.633,1070.404,1518.917L1070.404,1522.2"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T19 LE-T21" id="L-T19-T21-0" d="M228.227,1477.5L228.227,1481.667C228.227,1485.833,228.227,1494.167,228.227,1501.658C228.227,1509.15,228.227,1515.8,228.227,1519.125L228.227,1522.45"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T21 LE-T22" id="L-T21-T22-0" d="M228.227,1598.25L228.227,1602.458C228.227,1606.667,228.227,1615.083,272.814,1625.577C317.402,1636.071,406.578,1648.641,451.166,1654.926L495.754,1661.212"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T20 LE-T22" id="L-T20-T22-0" d="M1070.404,1598.5L1070.404,1602.667C1070.404,1606.833,1070.404,1615.167,1027.925,1625.504C985.446,1635.841,900.487,1648.183,858.008,1654.354L815.528,1660.524"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T22 LE-T23" id="L-T22-T23-0" d="M655.643,1719L655.643,1723.167C655.643,1727.333,655.643,1735.667,655.643,1743.117C655.643,1750.567,655.643,1757.133,655.643,1760.417L655.643,1763.7"/><path marker-end="url(#mermaid-svg-1753804172703-07orbrmyt_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-T23 LE-T24" id="L-T23-T24-0" d="M655.643,1840L655.643,1844.167C655.643,1848.333,655.643,1856.667,655.643,1864.117C655.643,1871.567,655.643,1878.133,655.643,1881.417L655.643,1884.7"/></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(678.6796875, 59)" id="flowchart-T1-509" class="node default default flowchart-label"><rect height="52" width="193.921875" y="-26" x="-96.9609375" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-89.4609375, -18.5)" style="" class="label"><rect/><foreignObject height="37" width="178.921875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Layer Input x<br />batch_size, seq_len, dim</span></div></foreignObject></g></g><g transform="translate(678.6796875, 170.25)" id="flowchart-T2-511" class="node default norm flowchart-label"><rect height="70.5" width="252.2890625" y="-35.25" x="-126.14453125" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-118.64453125, -27.75)" style="" class="label"><rect/><foreignObject height="55.5" width="237.2890625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Attention RMSNorm<br />normalize: dim<br />output: batch_size, seq_len, dim</span></div></foreignObject></g></g><g transform="translate(244.03125, 291)" id="flowchart-T3-513" class="node default linear flowchart-label"><rect height="71" width="372.5" y="-35.5" x="-186.25" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-178.75, -28)" style="" class="label"><rect/><foreignObject height="56" width="357.5"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Q Projection<br />Linear: dim → n_heads × head_size<br />output: batch_size, seq_len, n_heads × head_size</span></div></foreignObject></g></g><g transform="translate(678.6796875, 291)" id="flowchart-T4-515" class="node default linear flowchart-label"><rect height="71" width="396.796875" y="-35.5" x="-198.3984375" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-190.8984375, -28)" style="" class="label"><rect/><foreignObject height="56" width="381.796875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">K Projection<br />Linear: dim → n_kv_heads × head_size<br />output: batch_size, seq_len, n_kv_heads × head_size</span></div></foreignObject></g></g><g transform="translate(1048.525390625, 514)" id="flowchart-T5-517" class="node default linear flowchart-label"><rect height="71" width="396.796875" y="-35.5" x="-198.3984375" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-190.8984375, -28)" style="" class="label"><rect/><foreignObject height="56" width="381.796875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">V Projection<br />Linear: dim → n_kv_heads × head_size<br />output: batch_size, seq_len, n_kv_heads × head_size</span></div></foreignObject></g></g><g transform="translate(244.03125, 402.5)" id="flowchart-T6-519" class="node default default flowchart-label"><rect height="52" width="306.796875" y="-26" x="-153.3984375" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-145.8984375, -18.5)" style="" class="label"><rect/><foreignObject height="37" width="291.796875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Reshape Q<br />batch_size, seq_len, n_heads, head_size</span></div></foreignObject></g></g><g transform="translate(678.6796875, 402.5)" id="flowchart-T7-521" class="node default default flowchart-label"><rect height="52" width="331.09375" y="-26" x="-165.546875" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-158.046875, -18.5)" style="" class="label"><rect/><foreignObject height="37" width="316.09375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Reshape K<br />batch_size, seq_len, n_kv_heads, head_size</span></div></foreignObject></g></g><g transform="translate(1048.525390625, 634.75)" id="flowchart-T8-523" class="node default default flowchart-label"><rect height="52" width="331.09375" y="-26" x="-165.546875" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-158.046875, -18.5)" style="" class="label"><rect/><foreignObject height="37" width="316.09375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Reshape V<br />batch_size, seq_len, n_kv_heads, head_size</span></div></foreignObject></g></g><g transform="translate(244.03125, 514)" id="flowchart-T9-525" class="node default default flowchart-label"><rect height="52" width="205.4375" y="-26" x="-102.71875" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-95.21875, -18.5)" style="" class="label"><rect/><foreignObject height="37" width="190.4375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Apply RoPE to Q<br />Rotary Position Embedding</span></div></foreignObject></g></g><g transform="translate(678.6796875, 514)" id="flowchart-T10-527" class="node default default flowchart-label"><rect height="52" width="205.4375" y="-26" x="-102.71875" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-95.21875, -18.5)" style="" class="label"><rect/><foreignObject height="37" width="190.4375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Apply RoPE to K<br />Rotary Position Embedding</span></div></foreignObject></g></g><g transform="translate(1048.525390625, 746)" id="flowchart-T11-529" class="node default default flowchart-label"><rect height="33.5" width="106.1875" y="-16.75" x="-53.09375" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-45.59375, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="91.1875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">V unchanged</span></div></foreignObject></g></g><g transform="translate(461.35546875, 634.75)" id="flowchart-T12-531" class="node default attention flowchart-label"><rect height="70.5" width="346.0546875" y="-35.25" x="-173.02734375" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-165.52734375, -27.75)" style="" class="label"><rect/><foreignObject height="55.5" width="331.0546875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Attention Scores<br />Q matmul K_transpose / sqrt head_size<br />scores: batch_size, n_heads, seq_len, seq_len</span></div></foreignObject></g></g><g transform="translate(461.35546875, 746)" id="flowchart-T13-535" class="node default attention flowchart-label"><rect height="52" width="431.625" y="-26" x="-215.8125" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-208.3125, -18.5)" style="" class="label"><rect/><foreignObject height="37" width="416.625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Softmax<br />attention_weights: batch_size, n_heads, seq_len, seq_len</span></div></foreignObject></g></g><g transform="translate(655.642578125, 857.25)" id="flowchart-T14-537" class="node default attention flowchart-label"><rect height="70.5" width="365.1640625" y="-35.25" x="-182.58203125" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-175.08203125, -27.75)" style="" class="label"><rect/><foreignObject height="55.5" width="350.1640625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Weighted Sum<br />attention_weights matmul V<br />output: batch_size, n_heads, seq_len, head_size</span></div></foreignObject></g></g><g transform="translate(655.642578125, 968.5)" id="flowchart-T15-541" class="node default default flowchart-label"><rect height="52" width="381.0390625" y="-26" x="-190.51953125" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-183.01953125, -18.5)" style="" class="label"><rect/><foreignObject height="37" width="366.0390625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Concat Heads<br />reshape: batch_size, seq_len, n_heads × head_size</span></div></foreignObject></g></g><g transform="translate(655.642578125, 1080)" id="flowchart-T16-543" class="node default linear flowchart-label"><rect height="71" width="269.8203125" y="-35.5" x="-134.91015625" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-127.41015625, -28)" style="" class="label"><rect/><foreignObject height="56" width="254.8203125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Output Projection<br />Linear: n_heads × head_size → dim<br />output: batch_size, seq_len, dim</span></div></foreignObject></g></g><g transform="translate(655.642578125, 1200.75)" id="flowchart-T17-545" class="node default default flowchart-label"><rect height="70.5" width="245.8828125" y="-35.25" x="-122.94140625" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-115.44140625, -27.75)" style="" class="label"><rect/><foreignObject height="55.5" width="230.8828125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Residual Add 1<br />x + attention_output<br />shape: batch_size, seq_len, dim</span></div></foreignObject></g></g><g transform="translate(655.642578125, 1321.25)" id="flowchart-T18-547" class="node default norm flowchart-label"><rect height="70.5" width="252.2890625" y="-35.25" x="-126.14453125" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-118.64453125, -27.75)" style="" class="label"><rect/><foreignObject height="55.5" width="237.2890625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">FFN RMSNorm<br />normalize: dim<br />output: batch_size, seq_len, dim</span></div></foreignObject></g></g><g transform="translate(228.2265625, 1442)" id="flowchart-T19-549" class="node default linear flowchart-label"><rect height="71" width="309.28125" y="-35.5" x="-154.640625" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-147.140625, -28)" style="" class="label"><rect/><foreignObject height="56" width="294.28125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">W1 Projection<br />Linear: dim → hidden_dim<br />output: batch_size, seq_len, hidden_dim</span></div></foreignObject></g></g><g transform="translate(1070.404296875, 1563)" id="flowchart-T20-551" class="node default linear flowchart-label"><rect height="71" width="309.28125" y="-35.5" x="-154.640625" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-147.140625, -28)" style="" class="label"><rect/><foreignObject height="56" width="294.28125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">W3 Projection<br />Linear: dim → hidden_dim<br />output: batch_size, seq_len, hidden_dim</span></div></foreignObject></g></g><g transform="translate(228.2265625, 1563)" id="flowchart-T21-553" class="node default activation flowchart-label"><rect height="70.5" width="309.28125" y="-35.25" x="-154.640625" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-147.140625, -27.75)" style="" class="label"><rect/><foreignObject height="55.5" width="294.28125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">SiLU Activation<br />x * sigmoid of x<br />output: batch_size, seq_len, hidden_dim</span></div></foreignObject></g></g><g transform="translate(655.642578125, 1683.75)" id="flowchart-T22-555" class="node default activation flowchart-label"><rect height="70.5" width="309.28125" y="-35.25" x="-154.640625" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-147.140625, -27.75)" style="" class="label"><rect/><foreignObject height="55.5" width="294.28125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Element-wise Multiply<br />SiLU of W1 * W3<br />output: batch_size, seq_len, hidden_dim</span></div></foreignObject></g></g><g transform="translate(655.642578125, 1804.5)" id="flowchart-T23-559" class="node default linear flowchart-label"><rect height="71" width="252.2890625" y="-35.5" x="-126.14453125" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-118.64453125, -28)" style="" class="label"><rect/><foreignObject height="56" width="237.2890625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">W2 Projection<br />Linear: hidden_dim → dim<br />output: batch_size, seq_len, dim</span></div></foreignObject></g></g><g transform="translate(655.642578125, 1925.25)" id="flowchart-T24-561" class="node default default flowchart-label"><rect height="70.5" width="236.9609375" y="-35.25" x="-118.48046875" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-110.98046875, -27.75)" style="" class="label"><rect/><foreignObject height="55.5" width="221.9609375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Residual Add 2<br />x + ffn_output<br />final: batch_size, seq_len, dim</span></div></foreignObject></g></g></g></g><g transform="translate(1428.138671875, 988.75)" id="flowchart-A-491" class="node default input flowchart-label"><rect height="52" width="208.4296875" y="-26" x="-104.21484375" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-96.71484375, -18.5)" style="" class="label"><rect/><foreignObject height="37" width="193.4296875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Input Token IDs<br />shape: batch_size, seq_len</span></div></foreignObject></g></g><g transform="translate(1428.138671875, 2053.5)" id="flowchart-B-492" class="node default embedding flowchart-label"><rect height="52" width="272.2109375" y="-26" x="-136.10546875" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-128.60546875, -18.5)" style="" class="label"><rect/><foreignObject height="37" width="257.2109375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Token Embedding Lookup<br />embedding_table: vocab_size × dim</span></div></foreignObject></g></g><g transform="translate(1428.138671875, 2155.5)" id="flowchart-C-494" class="node default embedding flowchart-label"><rect height="52" width="245.8828125" y="-26" x="-122.94140625" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-115.44140625, -18.5)" style="" class="label"><rect/><foreignObject height="37" width="230.8828125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Token Embeddings<br />shape: batch_size, seq_len, dim</span></div></foreignObject></g></g><g transform="translate(1428.138671875, 2257.5)" id="flowchart-D-496" class="node default default flowchart-label"><rect height="52" width="158.6953125" y="-26" x="-79.34765625" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-71.84765625, -18.5)" style="" class="label"><rect/><foreignObject height="37" width="143.6953125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Transformer Layer 0<br />(repeat L times)</span></div></foreignObject></g></g><g transform="translate(1428.138671875, 2350.25)" id="flowchart-E-498" class="node default default flowchart-label"><rect height="33.5" width="158.6953125" y="-16.75" x="-79.34765625" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-71.84765625, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="143.6953125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Transformer Layer 1</span></div></foreignObject></g></g><g transform="translate(1428.138671875, 2433.75)" id="flowchart-F-500" class="node default default flowchart-label"><rect height="33.5" width="32.625" y="-16.75" x="-16.3125" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-8.8125, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="17.625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">...</span></div></foreignObject></g></g><g transform="translate(1428.138671875, 2517.25)" id="flowchart-G-502" class="node default default flowchart-label"><rect height="33.5" width="172.671875" y="-16.75" x="-86.3359375" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-78.8359375, -9.25)" style="" class="label"><rect/><foreignObject height="18.5" width="157.671875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Transformer Layer L-1</span></div></foreignObject></g></g><g transform="translate(1428.138671875, 2619.25)" id="flowchart-H-504" class="node default norm flowchart-label"><rect height="70.5" width="252.2890625" y="-35.25" x="-126.14453125" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-118.64453125, -27.75)" style="" class="label"><rect/><foreignObject height="55.5" width="237.2890625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Final RMSNorm<br />input: batch_size, seq_len, dim<br />output: batch_size, seq_len, dim</span></div></foreignObject></g></g><g transform="translate(1428.138671875, 2740)" id="flowchart-I-506" class="node default linear flowchart-label"><rect height="71" width="302.9453125" y="-35.5" x="-151.47265625" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-143.97265625, -28)" style="" class="label"><rect/><foreignObject height="56" width="287.9453125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Output Projection<br />Linear: dim → vocab_size<br />output: batch_size, seq_len, vocab_size</span></div></foreignObject></g></g><g transform="translate(1428.138671875, 2851.5)" id="flowchart-J-508" class="node default output flowchart-label"><rect height="52" width="296.5390625" y="-26" x="-148.26953125" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-140.76953125, -18.5)" style="" class="label"><rect/><foreignObject height="37" width="281.5390625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Final Logits<br />shape: batch_size, seq_len, vocab_size</span></div></foreignObject></g></g></g></g></g></svg>